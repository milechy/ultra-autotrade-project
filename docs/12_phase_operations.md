# 12_phase_operations.md
# フェーズ運用ルール統合版（Phase Operations Rules）

このドキュメントは、  
**OctoBot × AI × Notion × Aave 自動運用システム** の開発における  
「各フェーズチャット」「GPTの行動ルール」「開発フロー」を  
一つにまとめた *プロジェクト運用の中心文書* です。

GPTプロジェクトが破綻せず、常に同期された状態を保つためのルールを明確化します。

---

# 🎯 目的
- GPTの認知ズレをゼロにする  
- 人間とGPT間で一貫した開発フローを維持する  
- 各フェーズを自動かつ安全に進行させる  
- 要件変更・仕様変更がブレずに伝達されるようにする  
- GitHub運用、Zip構築、システムプロンプト生成まで含む完全自動化の実現  

---

# ======================
# 🧠 1. フェーズ全体の開発フロー
# ======================

各フェーズは以下の順で実行される：

1. フェーズ用システムプロンプトを貼る  
2. GPTが .md を読み込み、前提を同期  
3. GPTが作業対象ファイル名＋変更概要を提示  
4. 人間が「OK」と言う  
5. GPTがコード・設計を生成  
6. GPTがフェーズ終了処理を行う  
7. GPTが次フェーズ用システムプロンプトを自動生成  
8. 人間がそのプロンプトを次フェーズのチャットに貼る  

---

# ==============================
# 🧠 2. GPTが必ず守るべき重要ルール（あなたの指示を統合）
# ==============================

## ✔ 2.1 作業前に「必ず」ファイル名を提示する
GPTはコードを書く前に次を必ず行う：

- 編集する既存ファイル名  
- 作成する新規ファイル名  
- そのファイルで何を変更・追加するか（概要）

※ **この“事前宣言”が完了するまでコードを書いてはいけない。**

---

## ✔ 2.2 フェーズ完了時の必須タスク（あなたの指示の完全版）

フェーズが終わるとき、GPTは以下を必ず実行する：

### 🔹 ① そのフェーズで作業した内容のまとめ  
（重要決定・変更仕様・作成ファイル）

### 🔹 ② それを .md に反映する案を提示  
- 対象ファイル名  
- 修正箇所  
- 文章案（diff式）

### 🔹 ③ GitHub Issue案 を作成  
- タイトル  
- 詳細説明  
- ラベル  
- タスク一覧  

### 🔹 ④ GitHub PR案 を作成  
- タイトル  
- 変更点の要約  
- チェックリスト  
- リスク情報  

### 🔹 ⑤ Git ブランチ名とコミット例を提示  
例：
```

git checkout -b feature/phase4-aave-ops
git add .
git commit -m "Phase4: Implement Aave deposit/withdraw logic"
git push origin feature/phase4-aave-ops

```

### 🔹 ⑥ 次フェーズで必要となるファイルリストを作成  
例：
- backend/app/aave/handler.py  
- docs/07_aave_operation_logic.md  

### 🔹 ⑦ それを Zip にまとめるためのスクリプト案を提示  
例：
```

zip next_phase.zip backend/app/aave/*.py docs/*.md

```

### 🔹 ⑧ 次フェーズの最初にGPTに貼る「システムプロンプト」を生成  
→ これが認知同期の中心

---

## ✔ 2.3 要件変更は必ず「要件変更チャット」へ

フェーズチャットでは：

❌ 新しい要件  
❌ 機能追加  
❌ 提案の検討  
❌ ロジック変更  
❌ デザイン変更  

は一切しない。

GPTは必ず次のように返す：

> 「これは要件変更です。要件変更チャットに入力してください。」

---

## ✔ 2.4 GPTは常に最新.mdを唯一の正しい仕様とみなす
- 会話内容より .md が優先  
- 過去フェーズのログより .md が優先  
- 「仕様の解釈に迷ったら .md を参照する」  

---

## ✔ 2.5 GPTは「推測で進める」ことを禁止
分からない点は必ず質問する。

---

# =====================================
# 🧠 3. フェーズ開始時の GPT の義務
# =====================================

各フェーズ開始時に GPT は必ず：

1. 使用するべき .md の整合性を確認  
2. 重要ファイルを読み込む（名前だけでOK）  
3. フェーズ範囲外の作業をしないことを再確認  
4. タスクの優先順位を理解  
5. 必要であれば質問  

GPTは「準備完了」を宣言してから作業に入る。

---

# =====================================
# 🧠 4. フェーズ終了時の「完全自動処理」
# =====================================

フェーズ終了処理には次の要素が含まれる：

- 仕様反映（.md修正案）  
- GitHub Issue案  
- GitHub PR案  
- Gitコマンド案  
- 次フェーズファイルリスト  
- Zip生成スクリプト  
- **次フェーズ用GPTシステムプロンプト生成** ←最重要  

これにより、  
フェーズ間の認知ズレは完全に消える。

---

# ==============================
# 🧠 5. 自動プロンプト同期の流れ（完全図解）
# ==============================

```

フェーズ開始
↓
GPT：.md読み込み→同期
↓
GPT：変更前にファイル名＋概要提示
↓（OK）
コード生成
↓
フェーズ終了処理（Issue, PR, md更新案）
↓
GPT：次フェーズ用システムプロンプト自動生成
↓
人間が次フェーズチャットに貼る
↓
次フェーズ開始（同期済）

```

→ **プロジェクト全体が自動で自己同期して進む仕組み**

---

# ==============================
# 🧠 6. GPTがやってはならない行為（禁止事項）
# ==============================

- ❌ 承認前にコードを書く  
- ❌ フェーズ範囲外の作業を始める  
- ❌ .md への無断変更  
- ❌ 要件変更をフェーズチャットで扱う  
- ❌ 推測で仕様を補完する  
- ❌ 古い仕様書を使う  

---